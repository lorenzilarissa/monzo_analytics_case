version: 2

models:
  - name: dim_account_status
    description: "Dimension table that stores the current lifecycle status of each account (Open, Closed, or Reopened)."
    columns:
      - name: account_id
        description: "Unique identifier for the account (Natural Key)."
        tests:
          - not_null
          - unique

      - name: last_event_at
        description: "Timestamp of the most recent status change."

      - name: current_status
        description: "The current status of the account (OPEN, CLOSED, or REOPENED)."

      - name: previous_event_type
        description: "The status immediately preceding the current one."

      - name: is_currently_open
        description: "Boolean flag indicating if the account is presently in an active state."
        tests:
          - not_null
