version: 2

sources:
  - name: monzo_raw
    description: Raw event logs from Monzo account lifecycle and daily transactions.
    database: analytics-take-home-test
    schema: monzo_datawarehouse
    
    tables:
      - name: account_created
        description: Log of all new accounts opened by users.
        columns:
          - name: account_id_hashed
            description: Primary key for the account (hashed).
            tests:
              - not_null
          - name: user_id_hashed
            description: Unique identifier for the user (hashed).
            tests:
              - not_null
          - name: account_type
            description: Type of account opened (e.g., individual, joint).
          - name: created_ts
            description: Timestamp of account creation.

      - name: account_closed
        description: Log of account closure events.
        columns:
          - name: account_id_hashed
            description: Hashed ID of the closed account.
            tests:
              - not_null
          - name: closed_ts
            description: Timestamp when the account was closed.

      - name: account_reopened
        description: Log of accounts that were reopened after being closed.
        columns:
          - name: account_id_hashed
            description: Hashed ID of the reopened account.
            tests:
              - not_null
          - name: reopened_ts
            description: Timestamp when the account was reopened.

      - name: account_transactions
        description: Daily aggregated transaction counts per account.
        columns:
          - name: account_id_hashed
            description: Hashed ID of the account.
            tests:
              - not_null
          - name: date
            description: Date of the transactions (YYYY-MM-DD).
            tests:
              - not_null
          - name: transactions_num
            description: Total number of transactions for that account on that day.
